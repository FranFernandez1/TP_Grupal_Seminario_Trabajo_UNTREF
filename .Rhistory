'Porcentaje de Informalidad'      = percent(Informales/Ocupados, accuracy = 0.1),
'Porcentaje de Formalidad'      = percent(Formales/Ocupados, accuracy = 0.1)
)
# Agregamos separadores de miles
Cuadro_Formalidad_Reino_Unido <- Cuadro_Formalidad_Reino_Unido %>%
select(Ocupados,Formales,Informales,'Porcentaje de Formalidad','Porcentaje de Informalidad') %>%
mutate(across(c(Ocupados,Formales,Informales), ~ format(., big.mark = ".", decimal.mark = ",")))
#Visualizamos los indicadores adicionales de Formalidad e Informalidad en Reino Unido
kable(Cuadro_Formalidad_Reino_Unido, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores Adicionales del Mercado de Trabajo de Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
# Agregamos separadores de miles
Cuadro_Formalidad_ESPAÑA <- Cuadro_Formalidad_ESPAÑA %>%
select(País,Ocupados,Formales,Informales,'Porcentaje de Formalidad','Porcentaje de Informalidad') %>%
mutate(across(c(Ocupados,Formales,Informales), ~ format(., big.mark = ".", decimal.mark = ",")))
Cuadro_Formalidad_ESPAÑA <- bbdd_espana %>%
summarise( Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
País="España",
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
cuenta_propistas = sum( ((STAPRO == 0)&(SIZEFIRM == 99))  *(COEFF*1000),na.rm=TRUE),
Salario_Parcial_o_Cuenta_propia_sin_empleados = sum( ((SIGNISAL %in% c(1,2,3)) |((STAPRO == 0)&(SIZEFIRM == 99))    ) * (COEFF * 1000), na.rm = TRUE),
Informales=Salario_Parcial_o_Cuenta_propia_sin_empleados,
Formales=Ocupados-Informales,
'Porcentaje de Informalidad'      = percent(Informales/Ocupados, accuracy = 0.1),
'Porcentaje de Formalidad'      = percent(Formales/Ocupados, accuracy = 0.1)
)
# Agregamos separadores de miles
Cuadro_Formalidad_ESPAÑA <- Cuadro_Formalidad_ESPAÑA %>%
select(País,Ocupados,Formales,Informales,'Porcentaje de Formalidad','Porcentaje de Informalidad') %>%
mutate(across(c(Ocupados,Formales,Informales), ~ format(., big.mark = ".", decimal.mark = ",")))
#Visualizamos los indicadores adicionales de Formalidad e Informalidad en España
kable(Cuadro_Formalidad_ESPAÑA, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores Adicionales del Mercado de Trabajo de España - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
Cuadro_Formalidad_Reino_Unido <- bbdd_uk %>%
summarise( Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
País="Reino Unido",
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
cuenta_propistas = sum( ((STAPRO == 0)&(SIZEFIRM == 99))  *(COEFF*1000),na.rm=TRUE),
Salario_Parcial_o_Cuenta_propia_sin_empleados = sum( ((SIGNISAL %in% c(1,2,3)) | ((STAPRO == 0)&(SIZEFIRM == 99)) ) * (COEFF * 1000), na.rm = TRUE),
Informales=Salario_Parcial_o_Cuenta_propia_sin_empleados,
Formales=Ocupados-Informales,
'Porcentaje de Informalidad'      = percent(Informales/Ocupados, accuracy = 0.1),
'Porcentaje de Formalidad'      = percent(Formales/Ocupados, accuracy = 0.1)
)
# Agregamos separadores de miles
Cuadro_Formalidad_Reino_Unido <- Cuadro_Formalidad_Reino_Unido %>%
select(País,Ocupados,Formales,Informales,'Porcentaje de Formalidad','Porcentaje de Informalidad') %>%
mutate(across(c(Ocupados,Formales,Informales), ~ format(., big.mark = ".", decimal.mark = ",")))
#Visualizamos los indicadores adicionales de Formalidad e Informalidad en Reino Unido
kable(Cuadro_Formalidad_Reino_Unido, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores Adicionales del Mercado de Trabajo de Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
Cuadro_Precarizacion_ESPAÑA <- bbdd_espana %>%
summarise( Empleados              = sum((STAPRO %in% c(3,4))*(COEFF*1000),na.rm=TRUE),
País="España",
Temporales             = sum((TEMP == 2 )*(COEFF*1000),na.rm=TRUE),
Sin_pago_horas_extra   = sum((HWOVERPU >= 1 & HWOVERPU <= 98) * (COEFF * 1000), na.rm = TRUE),
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
Temporales_o_SinPagoHSEXTRA_sin_salario_completo = sum(((TEMP == 2 )| (HWOVERPU >= 1 & HWOVERPU <= 98) | (SIGNISAL %in% c(1,2,3)))*(COEFF*1000),na.rm=TRUE),
Precarizados=Temporales_o_SinPagoHSEXTRA_sin_salario_completo,
No_Precarizados=Empleados-Precarizados,
'Porcentaje de Precarizados'      = percent(Precarizados/Empleados, accuracy = 0.1),
'Porcentaje de No Precarizados'   = percent(No_Precarizados/Empleados, accuracy = 0.1)
)
# Agregamos separadores de miles
Cuadro_Precarizacion_ESPAÑA <- Cuadro_Precarizacion_ESPAÑA %>%
select(País,Empleados,No_Precarizados,Precarizados,'Porcentaje de No Precarizados','Porcentaje de Precarizados') %>%
mutate(across(c(Empleados,Precarizados,No_Precarizados), ~ format(., big.mark = ".", decimal.mark = ",")))
#Visualizamos los indicadores de Precarización Laboral en España
kable(Cuadro_Precarizacion_ESPAÑA, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de España - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
Cuadro_Precarizacion_Reino_Unido <- bbdd_uk %>%
summarise( Empleados              = sum((STAPRO %in% c(3,4))*(COEFF*1000),na.rm=TRUE),
País="España",
Temporales             = sum((TEMP == 2 )*(COEFF*1000),na.rm=TRUE),
Sin_pago_horas_extra   = sum((HWOVERPU >= 1 & HWOVERPU <= 98) * (COEFF * 1000), na.rm = TRUE),
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
Temporales_o_SinPagoHSEXTRA_sin_salario_completo = sum(((TEMP == 2 )| (HWOVERPU >= 1 & HWOVERPU <= 98) | (SIGNISAL %in% c(1,2,3)))*(COEFF*1000),na.rm=TRUE),
Precarizados=Temporales_o_SinPagoHSEXTRA_sin_salario_completo,
No_Precarizados=Empleados-Precarizados,
'Porcentaje de Precarizados'      = percent(Precarizados/Empleados, accuracy = 0.1),
'Porcentaje de No Precarizados'   = percent(No_Precarizados/Empleados, accuracy = 0.1)
)
# Agregamos separadores de miles
Cuadro_Precarizacion_Reino_Unido <- Cuadro_Precarizacion_Reino_Unido %>%
select(País,Empleados,No_Precarizados,Precarizados,'Porcentaje de No Precarizados','Porcentaje de Precarizados') %>%
mutate(across(c(Empleados,Precarizados,No_Precarizados), ~ format(., big.mark = ".", decimal.mark = ",")))
Cuadro_Precarizacion_Reino_Unido <- bbdd_uk %>%
summarise( Empleados              = sum((STAPRO %in% c(3,4))*(COEFF*1000),na.rm=TRUE),
País="Reino Unido",
Temporales             = sum((TEMP == 2 )*(COEFF*1000),na.rm=TRUE),
Sin_pago_horas_extra   = sum((HWOVERPU >= 1 & HWOVERPU <= 98) * (COEFF * 1000), na.rm = TRUE),
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
Temporales_o_SinPagoHSEXTRA_sin_salario_completo = sum(((TEMP == 2 )| (HWOVERPU >= 1 & HWOVERPU <= 98) | (SIGNISAL %in% c(1,2,3)))*(COEFF*1000),na.rm=TRUE),
Precarizados=Temporales_o_SinPagoHSEXTRA_sin_salario_completo,
No_Precarizados=Empleados-Precarizados,
'Porcentaje de Precarizados'      = percent(Precarizados/Empleados, accuracy = 0.1),
'Porcentaje de No Precarizados'   = percent(No_Precarizados/Empleados, accuracy = 0.1)
)
# Agregamos separadores de miles
Cuadro_Precarizacion_Reino_Unido <- Cuadro_Precarizacion_Reino_Unido %>%
select(País,Empleados,No_Precarizados,Precarizados,'Porcentaje de No Precarizados','Porcentaje de Precarizados') %>%
mutate(across(c(Empleados,Precarizados,No_Precarizados), ~ format(., big.mark = ".", decimal.mark = ",")))
#Visualizamos los indicadores de Precarización Laboral en Reino Unido
kable(Cuadro_Precarizacion_Reino_Unido, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
# Unificar los datasets
Cuadro_Formalidad_Union <- bind_rows(Cuadro_Formalidad_ESPAÑA, Cuadro_Formalidad_Reino_Unido)
#Visualizamos los indicadores adicionales de Formalidad e Informalidad en Reino Unido
kable(Cuadro_Formalidad_Union, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores Adicionales del Mercado de Trabajo de Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
Cuadro_Formalidad_ESPAÑA <- bbdd_espana %>%
summarise( Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
cuenta_propistas = sum( ((STAPRO == 0)&(SIZEFIRM == 99))  *(COEFF*1000),na.rm=TRUE),
Salario_Parcial_o_Cuenta_propia_sin_empleados = sum( ((SIGNISAL %in% c(1,2,3)) |((STAPRO == 0)&(SIZEFIRM == 99))    ) * (COEFF * 1000), na.rm = TRUE),
Informales=Salario_Parcial_o_Cuenta_propia_sin_empleados,
Formales=Ocupados-Informales,
'Porcentaje de Informalidad'      = percent(Informales/Ocupados, accuracy = 0.1),
'Porcentaje de Formalidad'      = percent(Formales/Ocupados, accuracy = 0.1),
País="España"
)
Cuadro_Formalidad_Reino_Unido <- bbdd_uk %>%
summarise( Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
cuenta_propistas = sum( ((STAPRO == 0)&(SIZEFIRM == 99))  *(COEFF*1000),na.rm=TRUE),
Salario_Parcial_o_Cuenta_propia_sin_empleados = sum( ((SIGNISAL %in% c(1,2,3)) | ((STAPRO == 0)&(SIZEFIRM == 99)) ) * (COEFF * 1000), na.rm = TRUE),
Informales=Salario_Parcial_o_Cuenta_propia_sin_empleados,
Formales=Ocupados-Informales,
'Porcentaje de Informalidad'      = percent(Informales/Ocupados, accuracy = 0.1),
'Porcentaje de Formalidad'      = percent(Formales/Ocupados, accuracy = 0.1),
País="Reino Unido"
)
# Agregamos separadores de miles
Cuadro_Formalidad_ESPAÑA <- Cuadro_Formalidad_ESPAÑA %>%
select(País,Ocupados,Formales,Informales,'Porcentaje de Formalidad','Porcentaje de Informalidad') %>%
mutate(across(c(Ocupados,Formales,Informales), ~ format(., big.mark = ".", decimal.mark = ",")))
Cuadro_Formalidad_Reino_Unido <- Cuadro_Formalidad_Reino_Unido %>%
select(País,Ocupados,Formales,Informales,'Porcentaje de Formalidad','Porcentaje de Informalidad') %>%
mutate(across(c(Ocupados,Formales,Informales), ~ format(., big.mark = ".", decimal.mark = ",")))
# Unificar los datasets
Cuadro_Formalidad_Union <- bind_rows(Cuadro_Formalidad_ESPAÑA, Cuadro_Formalidad_Reino_Unido)
# Agregamos separadores de miles
Cuadro_Formalidad_ESPAÑA <- Cuadro_Formalidad_ESPAÑA %>%
select(País,Ocupados,Formales,Informales,'Porcentaje de Formalidad','Porcentaje de Informalidad') %>%
mutate(across(c(Ocupados,Formales,Informales), ~ format(., big.mark = ".", decimal.mark = ",")))
Cuadro_Formalidad_Reino_Unido <- Cuadro_Formalidad_Reino_Unido %>%
select(País,Ocupados,Formales,Informales,'Porcentaje de Formalidad','Porcentaje de Informalidad') %>%
mutate(across(c(Ocupados,Formales,Informales), ~ format(., big.mark = ".", decimal.mark = ",")))
# Unificar los datasets
Cuadro_Formalidad_Union <- bind_rows(Cuadro_Formalidad_ESPAÑA, Cuadro_Formalidad_Reino_Unido)
#Visualizamos los indicadores adicionales de Formalidad e Informalidad en España y Reino Unido
kable(Cuadro_Formalidad_Union, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores Adicionales del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
Cuadro_Precarizacion_ESPAÑA <- bbdd_espana %>%
summarise( Empleados              = sum((STAPRO %in% c(3,4))*(COEFF*1000),na.rm=TRUE),
Temporales             = sum((TEMP == 2 )*(COEFF*1000),na.rm=TRUE),
Sin_pago_horas_extra   = sum((HWOVERPU >= 1 & HWOVERPU <= 98) * (COEFF * 1000), na.rm = TRUE),
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
Temporales_o_SinPagoHSEXTRA_sin_salario_completo = sum(((TEMP == 2 )| (HWOVERPU >= 1 & HWOVERPU <= 98) | (SIGNISAL %in% c(1,2,3)))*(COEFF*1000),na.rm=TRUE),
Precarizados=Temporales_o_SinPagoHSEXTRA_sin_salario_completo,
No_Precarizados=Empleados-Precarizados,
'Porcentaje de Precarizados'      = percent(Precarizados/Empleados, accuracy = 0.1),
'Porcentaje de No Precarizados'   = percent(No_Precarizados/Empleados, accuracy = 0.1),
País="España"
)
Cuadro_Precarizacion_Reino_Unido <- bbdd_uk %>%
summarise( Empleados              = sum((STAPRO %in% c(3,4))*(COEFF*1000),na.rm=TRUE),
Temporales             = sum((TEMP == 2 )*(COEFF*1000),na.rm=TRUE),
Sin_pago_horas_extra   = sum((HWOVERPU >= 1 & HWOVERPU <= 98) * (COEFF * 1000), na.rm = TRUE),
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
Temporales_o_SinPagoHSEXTRA_sin_salario_completo = sum(((TEMP == 2 )| (HWOVERPU >= 1 & HWOVERPU <= 98) | (SIGNISAL %in% c(1,2,3)))*(COEFF*1000),na.rm=TRUE),
Precarizados=Temporales_o_SinPagoHSEXTRA_sin_salario_completo,
No_Precarizados=Empleados-Precarizados,
'Porcentaje de Precarizados'      = percent(Precarizados/Empleados, accuracy = 0.1),
'Porcentaje de No Precarizados'   = percent(No_Precarizados/Empleados, accuracy = 0.1),
País="Reino Unido"
)
# Agregamos separadores de miles
Cuadro_Precarizacion_ESPAÑA <- Cuadro_Precarizacion_ESPAÑA %>%
select(País,Empleados,No_Precarizados,Precarizados,'Porcentaje de No Precarizados','Porcentaje de Precarizados') %>%
mutate(across(c(Empleados,Precarizados,No_Precarizados), ~ format(., big.mark = ".", decimal.mark = ",")))
Cuadro_Precarizacion_Reino_Unido <- Cuadro_Precarizacion_Reino_Unido %>%
select(País,Empleados,No_Precarizados,Precarizados,'Porcentaje de No Precarizados','Porcentaje de Precarizados') %>%
mutate(across(c(Empleados,Precarizados,No_Precarizados), ~ format(., big.mark = ".", decimal.mark = ",")))
# Unificar los datasets
Cuadro_Precarizacion_Union <- bind_rows(Cuadro_Precarizacion_ESPAÑA, Cuadro_Precarizacion_Reino_Unido)
#Visualizamos los indicadores de Precarización Laboral en Reino Unido
kable(Cuadro_Precarizacion_Union, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
library(ggplot2)
# Crear un dataframe con los datos relevantes
data <- Cuadro_Formalidad_Union %>%
select(País, 'Porcentaje de Formalidad', 'Porcentaje de Informalidad') %>%
pivot_longer(cols = c('Porcentaje de Formalidad', 'Porcentaje de Informalidad'),
names_to = "Tipo",
values_to = "Porcentaje")
# Convertir porcentajes a números sin el símbolo de porcentaje
data$Porcentaje <- as.numeric(gsub("%", "", data$Porcentaje))
create_pie_chart <- function(df, country) {
ggplot(df, aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Porcentaje de Formalidad e Informalidad en", country)) +
scale_fill_manual(values = c("Porcentaje de Formalidad" = "blue", "Porcentaje de Informalidad" = "red")) +
theme(legend.position = "right")
}
# Filtrar los datos para España y Reino Unido
data_espana <- data %>% filter(País == "España")
data_reino_unido <- data %>% filter(País == "Reino Unido")
# Crear los gráficos
pie_chart_espana <- create_pie_chart(data_espana, "España")
pie_chart_reino_unido <- create_pie_chart(data_reino_unido, "Reino Unido")
# Mostrar los gráficos
print(pie_chart_espana)
print(pie_chart_reino_unido)
# Mostrar los gráficos
print(pie_chart_espana)
print(pie_chart_reino_unido)
data <- Cuadro_Formalidad_Union %>%
select(País, 'Porcentaje de Formalidad', 'Porcentaje de Informalidad') %>%
pivot_longer(cols = c('Porcentaje de Formalidad', 'Porcentaje de Informalidad'),
names_to = "Tipo",
values_to = "Porcentaje") %>%
mutate(Porcentaje = as.numeric(gsub("%", "", Porcentaje)))
# Función para crear gráficos de torta
create_pie_chart <- function(df, country) {
ggplot(df %>% filter(País == country), aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Porcentaje de Formalidad e Informalidad en", country)) +
scale_fill_manual(values = c("Porcentaje de Formalidad" = "blue", "Porcentaje de Informalidad" = "red")) +
theme(legend.position = "right")
}
# Crear y mostrar los gráficos
print(create_pie_chart(data, "España"))
# Crear y mostrar los gráficos
print(create_pie_chart(data, "España"))
print(create_pie_chart(data, "Reino Unido"))
data <- Cuadro_Formalidad_Union %>%
select(País, 'Porcentaje de Formalidad', 'Porcentaje de Informalidad') %>%
pivot_longer(cols = c('Porcentaje de Formalidad', 'Porcentaje de Informalidad'),
names_to = "Tipo",
values_to = "Porcentaje") %>%
mutate(Porcentaje = as.numeric(gsub("%", "", Porcentaje)))
# Función para crear gráficos de torta
create_pie_chart <- function(df, country) {
ggplot(df %>% filter(País == country), aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Porcentaje de Formalidad e Informalidad en", country)) +
scale_fill_manual(values = c("Porcentaje de Formalidad" = "#B3CDE3", "Porcentaje de Informalidad" = "#FBB4AE")) +
theme(legend.position = "right")
}
# Crear y mostrar los gráficos
print(create_pie_chart(data, "España"))
print(create_pie_chart(data, "Reino Unido"))
library(ggplot2)
library(gridExtra)
# Convertir porcentajes a números sin el símbolo de porcentaje y preparar los datos
data <- Cuadro_Formalidad_Union %>%
select(País, 'Porcentaje de Formalidad', 'Porcentaje de Informalidad') %>%
pivot_longer(cols = c('Porcentaje de Formalidad', 'Porcentaje de Informalidad'),
names_to = "Tipo",
values_to = "Porcentaje") %>%
mutate(Porcentaje = as.numeric(gsub("%", "", Porcentaje)))
# Función para crear gráficos de torta
create_pie_chart <- function(df, country) {
ggplot(df %>% filter(País == country), aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Porcentaje de Formalidad e Informalidad en", country)) +
scale_fill_manual(values = c("Porcentaje de Formalidad" = "#B3CDE3", "Porcentaje de Informalidad" = "#FBB4AE")) +
theme(legend.position = "right")
}
# Crear los gráficos
pie_chart_espana <- create_pie_chart(data, "España")
pie_chart_reino_unido <- create_pie_chart(data, "Reino Unido")
# Mostrar los gráficos lado a lado
grid.arrange(pie_chart_espana, pie_chart_reino_unido, ncol = 2)
grid.arrange(pie_chart_espana, pie_chart_reino_unido, ncol = 2, widths = c(1.5, 1.5))
library(ggplot2)
library(gridExtra)
# Convertir porcentajes a números sin el símbolo de porcentaje y preparar los datos
data <- Cuadro_Formalidad_Union %>%
select(País, 'Porcentaje de Formalidad', 'Porcentaje de Informalidad') %>%
pivot_longer(cols = c('Porcentaje de Formalidad', 'Porcentaje de Informalidad'),
names_to = "Tipo",
values_to = "Porcentaje") %>%
mutate(Porcentaje = as.numeric(gsub("%", "", Porcentaje)))
# Función para crear gráficos de torta
create_pie_chart <- function(df, country) {
ggplot(df %>% filter(País == country), aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Porcentaje de Formalidad e Informalidad en", country)) +
scale_fill_manual(values = c("Porcentaje de Formalidad" = "#B3CDE3", "Porcentaje de Informalidad" = "#FBB4AE")) +
theme(legend.position = "right")
}
# Crear los gráficos
pie_chart_espana <- create_pie_chart(data, "España")
pie_chart_reino_unido <- create_pie_chart(data, "Reino Unido")
grid.arrange(pie_chart_espana, pie_chart_reino_unido, ncol = 2, widths = c(1.5, 1.5))
# Convertir porcentajes a números sin el símbolo de porcentaje y preparar los datos
data <- Cuadro_Formalidad_Union %>%
select(País, 'Porcentaje de Formalidad', 'Porcentaje de Informalidad') %>%
pivot_longer(cols = c('Porcentaje de Formalidad', 'Porcentaje de Informalidad'),
names_to = "Tipo",
values_to = "Porcentaje") %>%
mutate(Porcentaje = as.numeric(gsub("%", "", Porcentaje)))
# Función para crear gráficos de torta con títulos más pequeños
create_pie_chart <- function(df, country) {
ggplot(df %>% filter(País == country), aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Formalidad e Informalidad en", country)) +
scale_fill_manual(values = c("Porcentaje de Formalidad" = "#B3CDE3", "Porcentaje de Informalidad" = "#FBB4AE")) +
theme(legend.position = "right",
plot.title = element_text(size = 12, face = "bold"))  # Ajustar el tamaño del título
}
# Crear los gráficos con títulos más pequeños
pie_chart_espana <- create_pie_chart(data, "España")
pie_chart_reino_unido <- create_pie_chart(data, "Reino Unido")
# Mostrar los gráficos lado a lado con espacio adecuado entre ellos
grid.arrange(pie_chart_espana, pie_chart_reino_unido, ncol = 2, widths = c(1.5, 1.5), heights = c(1, 1.2))
# Convertir porcentajes a números sin el símbolo de porcentaje y preparar los datos
data <- Cuadro_Formalidad_Union %>%
select(País, 'Porcentaje de Formalidad', 'Porcentaje de Informalidad') %>%
pivot_longer(cols = c('Porcentaje de Formalidad', 'Porcentaje de Informalidad'),
names_to = "Tipo",
values_to = "Porcentaje") %>%
mutate(Porcentaje = as.numeric(gsub("%", "", Porcentaje)))
# Función para crear gráficos de torta con porcentajes dentro de los segmentos
create_pie_chart <- function(df, country) {
ggplot(df %>% filter(País == country), aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Formalidad e Informalidad en", country)) +
scale_fill_manual(values = c("Porcentaje de Formalidad" = "#B3CDE3", "Porcentaje de Informalidad" = "#FBB4AE")) +
geom_text(aes(label = paste0(Porcentaje, "%")), position = position_stack(vjust = 0.5)) +  # Mostrar porcentajes dentro de los segmentos
theme(legend.position = "right",
plot.title = element_text(size = 12, face = "bold"))  # Ajustar el tamaño del título
}
# Crear los gráficos con porcentajes dentro de los segmentos
pie_chart_espana <- create_pie_chart(data, "España")
pie_chart_reino_unido <- create_pie_chart(data, "Reino Unido")
# Mostrar los gráficos lado a lado con espacio adecuado entre ellos
grid.arrange(pie_chart_espana, pie_chart_reino_unido, ncol = 2, widths = c(1.5, 1.5), heights = c(1, 1.2))
# Convertir porcentajes a números sin el símbolo de porcentaje y preparar los datos
data <- Cuadro_Precarizacion_Union %>%
select(País, 'Porcentaje de No Precarizados', 'Porcentaje de Precarizados') %>%
pivot_longer(cols = c('Porcentaje de No Precarizados', 'Porcentaje de Precarizados'),
names_to = "Tipo",
values_to = "Porcentaje") %>%
mutate(Porcentaje = as.numeric(gsub("%", "", Porcentaje)))
# Función para crear gráficos de torta con porcentajes dentro de los segmentos
create_pie_chart <- function(df, country) {
ggplot(df %>% filter(País == country), aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Precarización Laboral en", country)) +
scale_fill_manual(values = c("Porcentaje de No Precarizados" = "#B3CDE3", "Porcentaje de Precarizados" = "#FBB4AE")) +
geom_text(aes(label = paste0(Porcentaje, "%")), position = position_stack(vjust = 0.5)) +  # Mostrar porcentajes dentro de los segmentos
theme(legend.position = "right",
plot.title = element_text(size = 12, face = "bold"))  # Ajustar el tamaño del título
}
# Crear los gráficos con porcentajes dentro de los segmentos
pie_chart_espana <- create_pie_chart(data, "España")
pie_chart_reino_unido <- create_pie_chart(data, "Reino Unido")
# Mostrar los gráficos lado a lado con espacio adecuado entre ellos
grid.arrange(pie_chart_espana, pie_chart_reino_unido, ncol = 2, widths = c(1.5, 1.5), heights = c(1, 1.2))
Cuadro_2_ESPAÑA <- bbdd_espana %>%
summarise(Poblacion             = sum(COEFF*1000, na.rm = TRUE),
Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
#Ocupados_OIT         = sum((ILOSTAT %in% c(1))*(COEFF*1000),na.rm=TRUE),
Desocupados           = sum((SEEKWORK %in% c(1,2,4))*(COEFF*1000),na.rm=TRUE),
#Desocupados_OIT      = sum((ILOSTAT %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos   = sum((SEEKWORK %in% c(3)|AVAILBLE %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos_OIT        = sum((ILOSTAT %in% c(3))*(COEFF*1000),na.rm=TRUE),
#Menores              = sum((WSTATOR %in% c(9))*(COEFF*1000),na.rm=TRUE),
PEA                   = Ocupados + Desocupados,
'Tasa Actividad'      = percent(PEA/Poblacion, accuracy = 0.1),
'Tasa Empleo'         = percent(Ocupados/Poblacion, accuracy = 0.1),
'Tasa Desocupacion'   = percent(Desocupados/PEA, accuracy = 0.1),
País="España"
)
Cuadro_2_UK <- bbdd_uk %>%
summarise(Poblacion             = sum(COEFF*1000, na.rm = TRUE),
Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
#Ocupados_OIT         = sum((ILOSTAT %in% c(1))*(COEFF*1000),na.rm=TRUE),
Desocupados           = sum((SEEKWORK %in% c(1,2,4))*(COEFF*1000),na.rm=TRUE),
#Desocupados_OIT      = sum((ILOSTAT %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos   = sum((SEEKWORK %in% c(3)|AVAILBLE %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos_OIT        = sum((ILOSTAT %in% c(3))*(COEFF*1000),na.rm=TRUE),
#Menores              = sum((WSTATOR %in% c(9))*(COEFF*1000),na.rm=TRUE),
PEA                   = Ocupados + Desocupados,
'Tasa Actividad'      = percent(PEA/Poblacion, accuracy = 0.1),
'Tasa Empleo'         = percent(Ocupados/Poblacion, accuracy = 0.1),
'Tasa Desocupacion'   = percent(Desocupados/PEA, accuracy = 0.1.),
Cuadro_2_UK <- bbdd_uk %>%
summarise(Poblacion             = sum(COEFF*1000, na.rm = TRUE),
Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
#Ocupados_OIT         = sum((ILOSTAT %in% c(1))*(COEFF*1000),na.rm=TRUE),
Desocupados           = sum((SEEKWORK %in% c(1,2,4))*(COEFF*1000),na.rm=TRUE),
#Desocupados_OIT      = sum((ILOSTAT %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos   = sum((SEEKWORK %in% c(3)|AVAILBLE %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos_OIT        = sum((ILOSTAT %in% c(3))*(COEFF*1000),na.rm=TRUE),
#Menores              = sum((WSTATOR %in% c(9))*(COEFF*1000),na.rm=TRUE),
PEA                   = Ocupados + Desocupados,
'Tasa Actividad'      = percent(PEA/Poblacion, accuracy = 0.1),
'Tasa Empleo'         = percent(Ocupados/Poblacion, accuracy = 0.1),
'Tasa Desocupacion'   = percent(Desocupados/PEA, accuracy = 0.1),
País="Reino Unido"
)
# Agregamos separadores de miles
Cuadro_2_ESPAÑA <- Cuadro_2_ESPAÑA %>%
mutate(across(c(Poblacion, Ocupados, Desocupados, PEA), ~ format(., big.mark = ".", decimal.mark = ",")))
Cuadro_2_UK <- Cuadro_2_UK %>%
mutate(across(c(Poblacion, Ocupados, Desocupados, PEA), ~ format(., big.mark = ".", decimal.mark = ",")))
# Unificar los datasets
Cuadro_Indicadores_Basicos_Union <- bind_rows(Cuadro_2_ESPAÑA, Cuadro_2_UK)
#Visualizamos los indicadores básicos de España y Reino Unido
kable(Cuadro_Indicadores_Basicos_Union, format = "html", table.attr = "class='table table-striped'", caption = "Tasas Básicas del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
Cuadro_2_ESPAÑA <- bbdd_espana %>%
summarise(País="España",
Poblacion             = sum(COEFF*1000, na.rm = TRUE),
Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
#Ocupados_OIT         = sum((ILOSTAT %in% c(1))*(COEFF*1000),na.rm=TRUE),
Desocupados           = sum((SEEKWORK %in% c(1,2,4))*(COEFF*1000),na.rm=TRUE),
#Desocupados_OIT      = sum((ILOSTAT %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos   = sum((SEEKWORK %in% c(3)|AVAILBLE %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos_OIT        = sum((ILOSTAT %in% c(3))*(COEFF*1000),na.rm=TRUE),
#Menores              = sum((WSTATOR %in% c(9))*(COEFF*1000),na.rm=TRUE),
PEA                   = Ocupados + Desocupados,
'Tasa Actividad'      = percent(PEA/Poblacion, accuracy = 0.1),
'Tasa Empleo'         = percent(Ocupados/Poblacion, accuracy = 0.1),
'Tasa Desocupacion'   = percent(Desocupados/PEA, accuracy = 0.1)
)
Cuadro_2_UK <- bbdd_uk %>%
summarise(País="Reino Unido",
Poblacion             = sum(COEFF*1000, na.rm = TRUE),
Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
#Ocupados_OIT         = sum((ILOSTAT %in% c(1))*(COEFF*1000),na.rm=TRUE),
Desocupados           = sum((SEEKWORK %in% c(1,2,4))*(COEFF*1000),na.rm=TRUE),
#Desocupados_OIT      = sum((ILOSTAT %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos   = sum((SEEKWORK %in% c(3)|AVAILBLE %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos_OIT        = sum((ILOSTAT %in% c(3))*(COEFF*1000),na.rm=TRUE),
#Menores              = sum((WSTATOR %in% c(9))*(COEFF*1000),na.rm=TRUE),
PEA                   = Ocupados + Desocupados,
'Tasa Actividad'      = percent(PEA/Poblacion, accuracy = 0.1),
'Tasa Empleo'         = percent(Ocupados/Poblacion, accuracy = 0.1),
'Tasa Desocupacion'   = percent(Desocupados/PEA, accuracy = 0.1)
)
# Agregamos separadores de miles
Cuadro_2_ESPAÑA <- Cuadro_2_ESPAÑA %>%
mutate(across(c(Poblacion, Ocupados, Desocupados, PEA), ~ format(., big.mark = ".", decimal.mark = ",")))
Cuadro_2_UK <- Cuadro_2_UK %>%
mutate(across(c(Poblacion, Ocupados, Desocupados, PEA), ~ format(., big.mark = ".", decimal.mark = ",")))
# Unificar los datasets
Cuadro_Indicadores_Basicos_Union <- bind_rows(Cuadro_2_ESPAÑA, Cuadro_2_UK)
#Visualizamos los indicadores básicos de España y Reino Unido
kable(Cuadro_Indicadores_Basicos_Union, format = "html", table.attr = "class='table table-striped'", caption = "Tasas Básicas del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
# Convertir porcentajes a números sin el símbolo de porcentaje y preparar los datos
data <- Cuadro_Precarizacion_Union %>%
select(País, 'Porcentaje de No Precarizados', 'Porcentaje de Precarizados') %>%
pivot_longer(cols = c('Porcentaje de No Precarizados', 'Porcentaje de Precarizados'),
names_to = "Tipo",
values_to = "Porcentaje") %>%
mutate(Porcentaje = as.numeric(gsub("%", "", Porcentaje)))
# Función para crear gráficos de torta con porcentajes dentro de los segmentos
create_pie_chart <- function(df, country) {
ggplot(df %>% filter(País == country), aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Precarización Laboral en", country)) +
scale_fill_manual(values = c("Porcentaje de No Precarizados" = "#B3CDE3", "Porcentaje de Precarizados" = "#FBB4AE")) +
geom_text(aes(label = paste0(Porcentaje, "%")), position = position_stack(vjust = 0.5)) +  # Mostrar porcentajes dentro de los segmentos
theme(legend.position = "right",
plot.title = element_text(size = 12, face = "bold"))  # Ajustar el tamaño del título
}
# Crear los gráficos con porcentajes dentro de los segmentos
pie_chart_espana <- create_pie_chart(data, "España")
pie_chart_reino_unido <- create_pie_chart(data, "Reino Unido")
# Mostrar los gráficos lado a lado
grid.arrange(pie_chart_espana, pie_chart_reino_unido, ncol = 2, widths = c(1.5, 1.5), heights = c(1, 1.2))
#Visualizamos los indicadores de Precarización Laboral en España y Reino Unido
kable(Cuadro_Precarizacion_Union, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
# Crear la tabla con kable
tabla_html <- kable(Cuadro_Precarizacion_Union, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
# Guardar la tabla como una imagen
tabla_img <- as_grob(tabla_html)
# Mostrar los gráficos lado a lado con la tabla debajo
plot_grid(
plot_grid(pie_chart_espana, pie_chart_reino_unido, ncol = 2, align = "v"),
tabla_img,
ncol = 1,
rel_heights = c(2, 1)
)
#Visualizamos los indicadores de Precarización Laboral en España y Reino Unido
kable(Cuadro_Precarizacion_Union, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
