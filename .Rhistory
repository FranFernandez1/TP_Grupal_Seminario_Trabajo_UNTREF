names_to = "Tipo",
values_to = "Porcentaje") %>%
mutate(Porcentaje = as.numeric(gsub("%", "", Porcentaje)))
# Función para crear gráficos de torta con porcentajes dentro de los segmentos
create_pie_chart <- function(df, country) {
ggplot(df %>% filter(País == country), aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Precarización Laboral en", country)) +
scale_fill_manual(values = c("Porcentaje de No Precarizados" = "#B3CDE3", "Porcentaje de Precarizados" = "#FBB4AE")) +
geom_text(aes(label = paste0(Porcentaje, "%")), position = position_stack(vjust = 0.5)) +  # Mostrar porcentajes dentro de los segmentos
theme(legend.position = "right",
plot.title = element_text(size = 12, face = "bold"))  # Ajustar el tamaño del título
}
# Crear los gráficos con porcentajes dentro de los segmentos
pie_chart_espana <- create_pie_chart(data, "España")
pie_chart_reino_unido <- create_pie_chart(data, "Reino Unido")
# Mostrar los gráficos lado a lado
grid.arrange(pie_chart_espana, pie_chart_reino_unido, ncol = 2, widths = c(1.5, 1.5), heights = c(1, 1.2))
#Visualizamos los indicadores de Precarización Laboral en España y Reino Unido
kable(Cuadro_Precarizacion_Union, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
# Crear la tabla con kable
tabla_html <- kable(Cuadro_Precarizacion_Union, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
# Guardar la tabla como una imagen
tabla_img <- as_grob(tabla_html)
# Mostrar los gráficos lado a lado con la tabla debajo
plot_grid(
plot_grid(pie_chart_espana, pie_chart_reino_unido, ncol = 2, align = "v"),
tabla_img,
ncol = 1,
rel_heights = c(2, 1)
)
#Visualizamos los indicadores de Precarización Laboral en España y Reino Unido
kable(Cuadro_Precarizacion_Union, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
knitr::opts_chunk$set(echo = TRUE)
# librerias
library(tidyverse)
library(ggplot2)
library(kableExtra)
#Cargar base de datos
base<-readRDS(file='Brasil_T32019.Rda')
summary(base)
var<-read.csv("Variables.csv", sep=";",na.strings=c("NA","NULL"),encoding="UTF-8")
var%>%
kable() %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
if (!require('scales')) install.packages('scales'); library('scales')
Cuadro_1.1a <- base %>%
summarise(Poblacion         = sum(V1028),
Ocupados          = sum(V1028[VD4002 == "Pessoas ocupadas"],na.rm=TRUE),
Desocupados       = sum(V1028[VD4002 == "Pessoas desocupadas"],na.rm=TRUE),
PEA               = Ocupados + Desocupados,
Subocupados       =  sum(V1028[(VD4004 =="Pessoas subocupadas"|VD4004A=="Pessoas subocupadas")],na.rm=TRUE),
'Tasa Actividad'                  = percent(PEA/Poblacion, accuracy = 0.1),
'Tasa Empleo'                     = percent(Ocupados/Poblacion, accuracy = 0.1),
'Tasa Desocupacion'               = percent(Desocupados/PEA, accuracy = 0.1),
'Tasa Subocupación'               = percent(Subocupados/PEA, accuracy = 0.1))
#Visualizamos los indicadores básicos de España y Reino Unido
kable(Cuadro_1.1a, format = "html", table.attr = "class='table table-striped'", caption = "Tasas Básicas del Mercado de Trabajo de Brasil - 2019, 3er trimestre. Fuente: PNAD continua") %>%
kable_styling(full_width = F, position = "center")
base<-base %>% mutate(Formalidad = case_when(VD4009 == "Empregado no setor privado com carteira de trabalho assinada"~ "Formal",###Formal
VD4009 == "Empregado no setor privado com carteira de trabalho assinada"~ "Formal",
VD4009 == "Empregado no setor público com carteira de trabalho assinada"~ "Formal",
VD4009 == "Militar e servidor estatutário"~ "Formal",
VD4009 == "Trabalhador doméstico com carteira de trabalho assinada"~ "Formal",
((VD4009 == "Conta-própria"| VD4009 == "Empregador")&V4019 == "Sim")~ "Formal",
VD4009 == "Empregado no setor privado sem carteira de trabalho assinada"~ "Informal",###Informal
VD4009 == "Empregado no setor público sem carteira de trabalho assinada"~ "Informal",
VD4009 == "Trabalhador doméstico sem carteira de trabalho assinada"~ "Informal",
VD4009 == "Trabalhador familiar auxiliar"~ "Informal",
((VD4009 == "Conta-própria"| VD4009 == "Empregador")&V4019 == "Não")~ "Informal"))
Formalidad <- base %>%
summarise(Ocupados          = sum(V1028[VD4002 == "Pessoas ocupadas"],na.rm=TRUE),
Sector_formal= sum(V1028[Formalidad == "Formal"],na.rm=TRUE),
Sector_informal= sum(V1028[Formalidad == "Informal"],na.rm=TRUE),
'Tasa Formalidad'= percent(Sector_formal/Ocupados, accuracy = 0.1),
'Tasa Informalidad'= percent(Sector_informal/Ocupados, accuracy = 0.1))
base<-base %>% mutate(Precariedad = case_when(((VD4009 == "Empregado no setor privado com carteira de trabalho assinada"|
VD4009 == "Empregado no setor privado com carteira de trabalho assinada"|
VD4009 == "Empregado no setor público com carteira de trabalho assinada"|
VD4009 == "Empregado no setor privado sem carteira de trabalho assinada"|
VD4009 == "Empregado no setor público sem carteira de trabalho assinada")&
(V4025=="Sim"|V4022=="Em domicílio de empregador, patrão, sócio ou freguês"))~"Precario",
(VD4009 == "Trabalhador familiar auxiliar"|
VD4009 == "Trabalhador doméstico com carteira de trabalho assinada"|
VD4009 == "Trabalhador doméstico sem carteira de trabalho assinada")~"Precario",
((VD4009 == "Empregado no setor privado com carteira de trabalho assinada"|
VD4009 == "Empregado no setor público com carteira de trabalho assinada"|
VD4009 == "Empregado no setor privado sem carteira de trabalho assinada"|
VD4009 == "Empregado no setor público sem carteira de trabalho assinada")&
(V4025=="Não"))~"No precario",
VD4009 == "Militar e servidor estatutário"~"No precario"))
base<-base %>% mutate(Asalariado = case_when((VD4009 == "Empregado no setor privado com carteira de trabalho assinada"|
VD4009 == "Empregado no setor público com carteira de trabalho assinada"|
VD4009 == "Empregado no setor privado sem carteira de trabalho assinada"|
VD4009 == "Empregado no setor público sem carteira de trabalho assinada"|
VD4009 == "Trabalhador familiar auxiliar"|
VD4009 == "Militar e servidor estatutário"|
VD4009 == "Trabalhador doméstico com carteira de trabalho assinada"|
VD4009 == "Trabalhador doméstico sem carteira de trabalho assinada")~"Asalariado"))
PrecariedadyFormalidad <- base %>%
summarise(Asalariados          = sum(V1028[Asalariado == "Asalariado"],na.rm=TRUE),
Sector_precario= sum(V1028[Precariedad == "Precario"],na.rm=TRUE),
Sector_no_precario= sum(V1028[Precariedad == "No precario"],na.rm=TRUE),
'Tasa Precariedad'= percent(Sector_precario/Asalariados, accuracy = 0.1),
'Tasa No precariedad'= percent(Sector_no_precario/Asalariados, accuracy = 0.1),
Ocupados          = sum(V1028[VD4002 == "Pessoas ocupadas"],na.rm=TRUE),
Sector_formal= sum(V1028[Formalidad == "Formal"],na.rm=TRUE),
Sector_informal= sum(V1028[Formalidad == "Informal"],na.rm=TRUE),
'Tasa Formalidad'= percent(Sector_formal/Ocupados, accuracy = 0.1),
'Tasa Informalidad'= percent(Sector_informal/Ocupados, accuracy = 0.1))
#Visualizamos los indicadores básicos de España y Reino Unido
kable(PrecariedadyFormalidad, format = "html", table.attr = "class='table table-striped'", caption = "Tasas de Precariedad e Informalidad del Mercado de Trabajo de Brasil - 2019, 3er trimestre. Fuente: PNAD continua") %>%
kable_styling(full_width = F, position = "center")
library(janitor)
PrecariedadyFormalidadxSexo <- base %>%filter(Precariedad=="Precario"|Precariedad=="No precario")%>% group_by(Precariedad,V2007) %>% summarise(n=n())%>% spread(V2007,n) %>%
adorn_totals(c("row", "col"))  %>%
adorn_percentages("row") %>%
adorn_pct_formatting(digits = 1) %>%
adorn_ns()
kable(PrecariedadyFormalidadxSexo, format = "html", table.attr = "class='table table-striped'", caption = "Tasas de Precariedad e Informalidad del Mercado de Trabajo de Brasil según sexo - 2019, 3er trimestre. Fuente: PNAD continua") %>%
kable_styling(full_width = F, position = "center")
#### Genero rangos etarios
base$V2009<-as.numeric(base$V2009)
base <-base %>% mutate (GRUPO_EDAD = case_when(V2009 < 5 ~ "00 a 04",
V2009 < 10 ~ "05 a 09",
V2009 < 15 ~ "10 a 14",
V2009 < 20 ~ "15 a 19",
V2009 < 25 ~ "20 a 24",
V2009 < 30 ~ "25 a 29",
V2009 < 35 ~ "30 a 34",
V2009 < 40 ~ "35 a 39",
V2009 < 45 ~ "40 a 44",
V2009 < 50 ~ "45 a 49",
V2009 < 55 ~ "50 a 54",
V2009 < 60 ~ "55 a 59",
V2009 < 65 ~ "60 a 64",
V2009 < 70 ~ "65 a 69",
V2009 < 75 ~ "70 a 74",
V2009 < 80 ~ "75 a 79",
V2009 < 85 ~ "80 a 84",
V2009 < 90 ~ "85 a 89",
V2009 < 95 ~ "90 a 94",
V2009 < 100 ~ "95 a 99",
V2009 <= 130 ~ "100 y más"))
base$GRUPO_EDAD <- factor(base$GRUPO_EDAD, levels = c("00 a 04","05 a 09","10 a 14","15 a 19","20 a 24",
"25 a 29","30 a 34","35 a 39","40 a 44","45 a 49",
"50 a 54","55 a 59","60 a 64","65 a 69","70 a 74",
"75 a 79","80 a 84","85 a 89","90 a 94","95 a 99",
"100 y más"))
PrecariedadyFormalidadxEdad <- base %>% filter(V2009<=130)%>%filter(Precariedad=="Precario"|Precariedad=="No precario")%>% group_by(Precariedad,GRUPO_EDAD) %>% summarise(n=n())%>% spread(Precariedad,n) %>%
adorn_totals(c("row", "col"))  %>%
adorn_percentages("row") %>%
adorn_pct_formatting(digits = 1) %>%
adorn_ns()
kable(PrecariedadyFormalidadxEdad, format = "html", table.attr = "class='table table-striped'", caption = "Tasas de Precariedad e Informalidad del Mercado de Trabajo de Brasil según edad  - 2019, 3er trimestre. Fuente: PNAD continua") %>%
kable_styling(full_width = F, position = "center")
Variables <- c("WSTATOR", "MAINSTAT", "COEFF", "STAPRO","SIZEFIRM","TEMP","HWOVERPU","SEEKWORK","AVAILBLE","SIGNISAL","SEX","AGE")
Descripcion <- c("Estado laboral durante la semana de referencia",
"Estado laboral general",
"Factor ponderador de la poblacion",
"Estatus Profesional",
"Tamaño de la empresa",
"Trabajo Temporal o Permanente",
"Cantidad de horas extras no pagas durante la semana de referencia",
"En búsqueda laboral",
"Disponibilidad para empezar a trabajar en las próximas dos semanas",
"Percibe regularmente su salario, aunque no asistió al trabajo en la semana de referencia",
"Sexo",
"Edad")
variable_table <- data.frame(Variable = Variables, Description = Descripcion)
variable_table %>%
kable() %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
## Cargamos las bases de datos
bbdd_uk=read.csv("reino_unido.csv")
bbdd_espana=read.csv("espana.csv")
## Calculamos los indicadores básicos laborales para España y Reino Unido
Cuadro_2_ESPAÑA <- bbdd_espana %>%
summarise(País="España",
Poblacion             = sum(COEFF*1000, na.rm = TRUE),
Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
#Ocupados_OIT         = sum((ILOSTAT %in% c(1))*(COEFF*1000),na.rm=TRUE),
Desocupados           = sum((SEEKWORK %in% c(1,2,4))*(COEFF*1000),na.rm=TRUE),
#Desocupados_OIT      = sum((ILOSTAT %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos   = sum((SEEKWORK %in% c(3)|AVAILBLE %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos_OIT        = sum((ILOSTAT %in% c(3))*(COEFF*1000),na.rm=TRUE),
#Menores              = sum((WSTATOR %in% c(9))*(COEFF*1000),na.rm=TRUE),
PEA                   = Ocupados + Desocupados,
'Tasa Actividad'      = percent(PEA/Poblacion, accuracy = 0.1),
'Tasa Empleo'         = percent(Ocupados/Poblacion, accuracy = 0.1),
'Tasa Desocupacion'   = percent(Desocupados/PEA, accuracy = 0.1)
)
Cuadro_2_UK <- bbdd_uk %>%
summarise(País="Reino Unido",
Poblacion             = sum(COEFF*1000, na.rm = TRUE),
Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
#Ocupados_OIT         = sum((ILOSTAT %in% c(1))*(COEFF*1000),na.rm=TRUE),
Desocupados           = sum((SEEKWORK %in% c(1,2,4))*(COEFF*1000),na.rm=TRUE),
#Desocupados_OIT      = sum((ILOSTAT %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos   = sum((SEEKWORK %in% c(3)|AVAILBLE %in% c(2))*(COEFF*1000),na.rm=TRUE),
#Inactivos_OIT        = sum((ILOSTAT %in% c(3))*(COEFF*1000),na.rm=TRUE),
#Menores              = sum((WSTATOR %in% c(9))*(COEFF*1000),na.rm=TRUE),
PEA                   = Ocupados + Desocupados,
'Tasa Actividad'      = percent(PEA/Poblacion, accuracy = 0.1),
'Tasa Empleo'         = percent(Ocupados/Poblacion, accuracy = 0.1),
'Tasa Desocupacion'   = percent(Desocupados/PEA, accuracy = 0.1)
)
# Agregamos separadores de miles
Cuadro_2_ESPAÑA <- Cuadro_2_ESPAÑA %>%
mutate(across(c(Poblacion, Ocupados, Desocupados, PEA), ~ format(., big.mark = ".", decimal.mark = ",")))
Cuadro_2_UK <- Cuadro_2_UK %>%
mutate(across(c(Poblacion, Ocupados, Desocupados, PEA), ~ format(., big.mark = ".", decimal.mark = ",")))
# Unificar los datasets
Cuadro_Indicadores_Basicos_Union <- bind_rows(Cuadro_2_ESPAÑA, Cuadro_2_UK)
#Visualizamos los indicadores básicos de España y Reino Unido
kable(Cuadro_Indicadores_Basicos_Union, format = "html", table.attr = "class='table table-striped'", caption = "Tasas Básicas del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
## Calculamos la formalidad e informalidad en España
Cuadro_Formalidad_ESPAÑA <- bbdd_espana %>%
summarise( Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
cuenta_propistas = sum( ((STAPRO == 0)&(SIZEFIRM == 99))  *(COEFF*1000),na.rm=TRUE),
Salario_Parcial_o_Cuenta_propia_sin_empleados = sum( ((SIGNISAL %in% c(1,2,3)) |((STAPRO == 0)&(SIZEFIRM == 99))    ) * (COEFF * 1000), na.rm = TRUE),
Informales=Salario_Parcial_o_Cuenta_propia_sin_empleados,
Formales=Ocupados-Informales,
'Porcentaje de Informalidad'      = percent(Informales/Ocupados, accuracy = 0.1),
'Porcentaje de Formalidad'      = percent(Formales/Ocupados, accuracy = 0.1),
País="España"
)
## Calculamos la formalidad e informalidad en Reino Unido
Cuadro_Formalidad_Reino_Unido <- bbdd_uk %>%
summarise( Ocupados              = sum((WSTATOR %in% c(1,2))*(COEFF*1000),na.rm=TRUE),
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
cuenta_propistas = sum( ((STAPRO == 0)&(SIZEFIRM == 99))  *(COEFF*1000),na.rm=TRUE),
Salario_Parcial_o_Cuenta_propia_sin_empleados = sum( ((SIGNISAL %in% c(1,2,3)) | ((STAPRO == 0)&(SIZEFIRM == 99)) ) * (COEFF * 1000), na.rm = TRUE),
Informales=Salario_Parcial_o_Cuenta_propia_sin_empleados,
Formales=Ocupados-Informales,
'Porcentaje de Informalidad'      = percent(Informales/Ocupados, accuracy = 0.1),
'Porcentaje de Formalidad'      = percent(Formales/Ocupados, accuracy = 0.1),
País="Reino Unido"
)
# Agregamos separadores de miles
Cuadro_Formalidad_ESPAÑA <- Cuadro_Formalidad_ESPAÑA %>%
select(País,Ocupados,Formales,Informales,'Porcentaje de Formalidad','Porcentaje de Informalidad') %>%
mutate(across(c(Ocupados,Formales,Informales), ~ format(., big.mark = ".", decimal.mark = ",")))
Cuadro_Formalidad_Reino_Unido <- Cuadro_Formalidad_Reino_Unido %>%
select(País,Ocupados,Formales,Informales,'Porcentaje de Formalidad','Porcentaje de Informalidad') %>%
mutate(across(c(Ocupados,Formales,Informales), ~ format(., big.mark = ".", decimal.mark = ",")))
# Unificar los datasets
Cuadro_Formalidad_Union <- bind_rows(Cuadro_Formalidad_ESPAÑA, Cuadro_Formalidad_Reino_Unido)
#Visualizamos los indicadores adicionales de Formalidad e Informalidad en España y Reino Unido
kable(Cuadro_Formalidad_Union, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores Adicionales del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
library(ggplot2)
library(gridExtra)
# Convertir porcentajes a números sin el símbolo de porcentaje y preparar los datos
data <- Cuadro_Formalidad_Union %>%
select(País, 'Porcentaje de Formalidad', 'Porcentaje de Informalidad') %>%
pivot_longer(cols = c('Porcentaje de Formalidad', 'Porcentaje de Informalidad'),
names_to = "Tipo",
values_to = "Porcentaje") %>%
mutate(Porcentaje = as.numeric(gsub("%", "", Porcentaje)))
# Función para crear gráficos de torta con porcentajes dentro de los segmentos
create_pie_chart <- function(df, country) {
ggplot(df %>% filter(País == country), aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Formalidad e Informalidad en", country)) +
scale_fill_manual(values = c("Porcentaje de Formalidad" = "#B3CDE3", "Porcentaje de Informalidad" = "#FBB4AE")) +
geom_text(aes(label = paste0(Porcentaje, "%")), position = position_stack(vjust = 0.5)) +  # Mostrar porcentajes dentro de los segmentos
theme(legend.position = "right",
plot.title = element_text(size = 12, face = "bold"))  # Ajustar el tamaño del título
}
# Crear los gráficos con porcentajes dentro de los segmentos
pie_chart_espana <- create_pie_chart(data, "España")
pie_chart_reino_unido <- create_pie_chart(data, "Reino Unido")
# Mostrar los gráficos lado a lado
grid.arrange(pie_chart_espana, pie_chart_reino_unido, ncol = 2, widths = c(1.5, 1.5), heights = c(1, 1.2))
## Calculamos la precarización laboral en España
Cuadro_Precarizacion_ESPAÑA <- bbdd_espana %>%
summarise( Empleados              = sum((STAPRO %in% c(3,4))*(COEFF*1000),na.rm=TRUE),
Temporales             = sum((TEMP == 2 )*(COEFF*1000),na.rm=TRUE),
Sin_pago_horas_extra   = sum((HWOVERPU >= 1 & HWOVERPU <= 98) * (COEFF * 1000), na.rm = TRUE),
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
Temporales_o_SinPagoHSEXTRA_sin_salario_completo = sum(((TEMP == 2 )| (HWOVERPU >= 1 & HWOVERPU <= 98) | (SIGNISAL %in% c(1,2,3)))*(COEFF*1000),na.rm=TRUE),
Precarizados=Temporales_o_SinPagoHSEXTRA_sin_salario_completo,
No_Precarizados=Empleados-Precarizados,
'Porcentaje de Precarizados'      = percent(Precarizados/Empleados, accuracy = 0.1),
'Porcentaje de No Precarizados'   = percent(No_Precarizados/Empleados, accuracy = 0.1),
País="España"
)
## Calculamos la precarización laboral en Reino Unido
Cuadro_Precarizacion_Reino_Unido <- bbdd_uk %>%
summarise( Empleados              = sum((STAPRO %in% c(3,4))*(COEFF*1000),na.rm=TRUE),
Temporales             = sum((TEMP == 2 )*(COEFF*1000),na.rm=TRUE),
Sin_pago_horas_extra   = sum((HWOVERPU >= 1 & HWOVERPU <= 98) * (COEFF * 1000), na.rm = TRUE),
No_perciben_salario_completo  = sum((SIGNISAL %in% c(1,2,3))*(COEFF*1000),na.rm=TRUE),
Temporales_o_SinPagoHSEXTRA_sin_salario_completo = sum(((TEMP == 2 )| (HWOVERPU >= 1 & HWOVERPU <= 98) | (SIGNISAL %in% c(1,2,3)))*(COEFF*1000),na.rm=TRUE),
Precarizados=Temporales_o_SinPagoHSEXTRA_sin_salario_completo,
No_Precarizados=Empleados-Precarizados,
'Porcentaje de Precarizados'      = percent(Precarizados/Empleados, accuracy = 0.1),
'Porcentaje de No Precarizados'   = percent(No_Precarizados/Empleados, accuracy = 0.1),
País="Reino Unido"
)
# Agregamos separadores de miles
Cuadro_Precarizacion_ESPAÑA <- Cuadro_Precarizacion_ESPAÑA %>%
select(País,Empleados,No_Precarizados,Precarizados,'Porcentaje de No Precarizados','Porcentaje de Precarizados') %>%
mutate(across(c(Empleados,Precarizados,No_Precarizados), ~ format(., big.mark = ".", decimal.mark = ",")))
Cuadro_Precarizacion_Reino_Unido <- Cuadro_Precarizacion_Reino_Unido %>%
select(País,Empleados,No_Precarizados,Precarizados,'Porcentaje de No Precarizados','Porcentaje de Precarizados') %>%
mutate(across(c(Empleados,Precarizados,No_Precarizados), ~ format(., big.mark = ".", decimal.mark = ",")))
# Unificar los datasets
Cuadro_Precarizacion_Union <- bind_rows(Cuadro_Precarizacion_ESPAÑA, Cuadro_Precarizacion_Reino_Unido)
#Visualizamos los indicadores de Precarización Laboral en España y Reino Unido
kable(Cuadro_Precarizacion_Union, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de España y Reino Unido - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
# Convertir porcentajes a números sin el símbolo de porcentaje y preparar los datos
data <- Cuadro_Precarizacion_Union %>%
select(País, 'Porcentaje de No Precarizados', 'Porcentaje de Precarizados') %>%
pivot_longer(cols = c('Porcentaje de No Precarizados', 'Porcentaje de Precarizados'),
names_to = "Tipo",
values_to = "Porcentaje") %>%
mutate(Porcentaje = as.numeric(gsub("%", "", Porcentaje)))
# Función para crear gráficos de torta con porcentajes dentro de los segmentos
create_pie_chart <- function(df, country) {
ggplot(df %>% filter(País == country), aes(x = "", y = Porcentaje, fill = Tipo)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
ggtitle(paste("Precarización Laboral en", country)) +
scale_fill_manual(values = c("Porcentaje de No Precarizados" = "#B3CDE3", "Porcentaje de Precarizados" = "#FBB4AE")) +
geom_text(aes(label = paste0(Porcentaje, "%")), position = position_stack(vjust = 0.5)) +  # Mostrar porcentajes dentro de los segmentos
theme(legend.position = "right",
plot.title = element_text(size = 12, face = "bold"))  # Ajustar el tamaño del título
}
# Crear los gráficos con porcentajes dentro de los segmentos
pie_chart_espana <- create_pie_chart(data, "España")
pie_chart_reino_unido <- create_pie_chart(data, "Reino Unido")
# Mostrar los gráficos lado a lado
grid.arrange(pie_chart_espana, pie_chart_reino_unido, ncol = 2, widths = c(1.5, 1.5), heights = c(1, 1.2))
## Cálculo de datos para Pirámide Poblacional de España
# Transformar los valores de SEX a "Hombre" y "Mujer"
bbdd_espana2 <- bbdd_espana %>%
mutate(Sexo = ifelse(SEX == 1, "Hombre", "Mujer"))
# Crear intervalos de edad en la base de datos
bbdd_espana2 <- bbdd_espana2 %>%
mutate(Edad_Grupo = cut(AGE, breaks = seq(0, 100, by = 10), right = FALSE, labels = c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80-89", "90+")))
# Asegurar que Edad_Grupo es un factor
bbdd_espana2$Edad_Grupo <- as.factor(bbdd_espana2$Edad_Grupo)
# Agrupar los datos por intervalos de edad y sexo considerando el factor de expansión
edad_sexo <- bbdd_espana2 %>%
group_by(Edad_Grupo, Sexo) %>%
summarise(Count = sum(COEFF * 1000, na.rm = TRUE)) %>%
ungroup()
# Crear gráfico de pirámide poblacional de España
ggplot(data = edad_sexo, aes(x = Edad_Grupo, y = ifelse(Sexo == "Hombre", -Count, Count), fill = Sexo)) +
geom_bar(stat = "identity") +
coord_flip() +
scale_y_continuous(labels = function(x) format(abs(x), big.mark = ".", decimal.mark = ".", scientific = FALSE)) +
labs(y = "Cantidad de Personas", x = "Grupo de Edad", title = "Pirámide Poblacional por Edad y Género en España") +
theme_minimal() +
scale_fill_manual(values = c("Hombre" = "#77dd77", "Mujer" = "#cba0dc"))
## Cálculo de datos para Pirámide Poblacional de Reino Unido
# Transformar los valores de SEX a "Hombre" y "Mujer"
bbdd_uk2 <- bbdd_uk %>%
mutate(Sexo = ifelse(SEX == 1, "Hombre", "Mujer"))
# Crear intervalos de edad en la base de datos
bbdd_uk2 <- bbdd_uk2 %>%
mutate(Edad_Grupo = cut(AGE, breaks = seq(0, 100, by = 10), right = FALSE, labels = c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80-89", "90+")))
# Asegurar que Edad_Grupo es un factor
bbdd_uk2$Edad_Grupo <- as.factor(bbdd_uk2$Edad_Grupo)
# Agrupar los datos por intervalos de edad y sexo considerando el factor de expansión
edad_sexo_uk <- bbdd_uk2 %>%
group_by(Edad_Grupo, Sexo) %>%
summarise(Count = sum(COEFF * 1000, na.rm = TRUE)) %>%
ungroup()
# Crear gráfico de pirámide poblacional de Reino Unido
ggplot(data = edad_sexo_uk, aes(x = Edad_Grupo, y = ifelse(Sexo == "Hombre", -Count, Count), fill = Sexo)) +
geom_bar(stat = "identity") +
coord_flip() +
scale_y_continuous(labels = function(x) format(abs(x), big.mark = ".", scientific = FALSE)) +
labs(y = "Cantidad de Personas", x = "Grupo de Edad", title = "Pirámide Poblacional por Edad y Género en Reino Unido") +
theme_minimal() +
scale_fill_manual(values = c("Hombre" = "#77dd77", "Mujer" = "#cba0dc"))
## Transformamos las variables Sexo y Edad
bbdd_espana3 <- mutate(bbdd_espana,
Edad_Periodo = cut(AGE,
breaks = c(15, 30, 45, 60, Inf),
labels = c("15-30", "30-45", "45-60", "60 o más"),
include.lowest = TRUE))%>%
filter(!is.na(Edad_Periodo))
bbdd_espana3 <- bbdd_espana3 %>%
mutate(Sexo = case_when(
SEX == 1 ~ "Hombre",
SEX == 2 ~ "Mujer",
TRUE ~ as.character(SEX)
))
## Calculamos la informalidad por Sexo y Edad
Cuadro_Formalidad_ESPAÑA2 <- bbdd_espana3 %>%
group_by(Edad_Periodo, Sexo) %>%  # Agrupar por edad y sexo
summarise(
Ocupados = sum((WSTATOR %in% c(1, 2)) * (COEFF * 1000), na.rm = TRUE),
No_perciben_salario_completo = sum((SIGNISAL %in% c(1, 2, 3)) * (COEFF * 1000), na.rm = TRUE),
cuenta_propistas = sum(((STAPRO == 0) & (SIZEFIRM == 99)) * (COEFF * 1000), na.rm = TRUE),
Salario_Parcial_o_Cuenta_propia_sin_empleados = sum(((SIGNISAL %in% c(1, 2, 3)) | ((STAPRO == 0) & (SIZEFIRM == 99))) * (COEFF * 1000), na.rm = TRUE),
Informales = Salario_Parcial_o_Cuenta_propia_sin_empleados,
Formales = Ocupados - Informales,
'Porcentaje de Informalidad' = percent(Informales / Ocupados, accuracy = 0.1),
'Porcentaje de Formalidad' = percent(Formales / Ocupados, accuracy = 0.1),
País = "España"
)
# Formatear y redondear las columnas
Cuadro_Formalidad_ESPAÑA2 <- Cuadro_Formalidad_ESPAÑA2 %>%
select(País, Edad_Periodo, Sexo, Ocupados, Formales, Informales, 'Porcentaje de Formalidad', 'Porcentaje de Informalidad') %>%
mutate(
across(c(Ocupados, Formales, Informales), ~ round(., digits = 0)),  # Redondear a enteros
across(c(Ocupados, Formales, Informales), ~ format(., big.mark = ".", decimal.mark = ","))
)
# Visualizar los indicadores en formato HTML
kable(Cuadro_Formalidad_ESPAÑA2, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Formalidad e Informalidad del Mercado de Trabajo de España según Sexo y Edad - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
## Transformamos las variables Sexo y Edad
bbdd_uk3 <- mutate(bbdd_uk,
Edad_Periodo = cut(AGE,
breaks = c(15, 30, 45, 60, Inf),
labels = c("15-30", "30-45", "45-60", "60 o más"),
include.lowest = TRUE))%>%
filter(!is.na(Edad_Periodo))
bbdd_uk3 <- bbdd_uk3 %>%
mutate(Sexo = case_when(
SEX == 1 ~ "Hombre",
SEX == 2 ~ "Mujer",
TRUE ~ as.character(SEX)
))
## Calculamos la informalidad por Sexo y Edad
Cuadro_Formalidad_UK2 <- bbdd_uk3 %>%
group_by(Edad_Periodo, Sexo) %>%  # Agrupar por edad y sexo
summarise(
Ocupados = sum((WSTATOR %in% c(1, 2)) * (COEFF * 1000), na.rm = TRUE),
No_perciben_salario_completo = sum((SIGNISAL %in% c(1, 2, 3)) * (COEFF * 1000), na.rm = TRUE),
cuenta_propistas = sum(((STAPRO == 0) & (SIZEFIRM == 99)) * (COEFF * 1000), na.rm = TRUE),
Salario_Parcial_o_Cuenta_propia_sin_empleados = sum(((SIGNISAL %in% c(1, 2, 3)) | ((STAPRO == 0) & (SIZEFIRM == 99))) * (COEFF * 1000), na.rm = TRUE),
Informales = Salario_Parcial_o_Cuenta_propia_sin_empleados,
Formales = Ocupados - Informales,
'Porcentaje de Informalidad' = percent(Informales / Ocupados, accuracy = 0.1),
'Porcentaje de Formalidad' = percent(Formales / Ocupados, accuracy = 0.1),
País = "Reino Unido"
)
# Formatear y redondear las columnas
Cuadro_Formalidad_UK2 <- Cuadro_Formalidad_UK2 %>%
select(País, Edad_Periodo, Sexo, Ocupados, Formales, Informales, 'Porcentaje de Formalidad', 'Porcentaje de Informalidad') %>%
mutate(
across(c(Ocupados, Formales, Informales), ~ round(., digits = 0)),  # Redondear a enteros
across(c(Ocupados, Formales, Informales), ~ format(., big.mark = ".", decimal.mark = ","))
)
# Visualizar los indicadores en formato HTML
kable(Cuadro_Formalidad_UK2, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Formalidad e Informalidad del Mercado de Trabajo de Reino Unido según Sexo y Edad - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
## Calculamos la precariedad laboral por Sexo y Edad para España
Cuadro_Precarizacion_ESPAÑA3 <- bbdd_espana3 %>%
group_by(Edad_Periodo, Sexo) %>%  # Agrupar por edad y sexo
summarise(
Empleados = sum((STAPRO %in% c(3,4)) * (COEFF * 1000), na.rm = TRUE),
Temporales = sum((TEMP == 2) * (COEFF * 1000), na.rm = TRUE),
Sin_pago_horas_extra = sum((HWOVERPU >= 1 & HWOVERPU <= 98) * (COEFF * 1000), na.rm = TRUE),
No_perciben_salario_completo = sum((SIGNISAL %in% c(1,2,3)) * (COEFF * 1000), na.rm = TRUE),
Temporales_o_SinPagoHSEXTRA_sin_salario_completo = sum(((TEMP == 2) | (HWOVERPU >= 1 & HWOVERPU <= 98) | (SIGNISAL %in% c(1,2,3))) * (COEFF * 1000), na.rm = TRUE),
Precarizados = Temporales_o_SinPagoHSEXTRA_sin_salario_completo,
No_Precarizados = Empleados - Precarizados,
'Porcentaje de Precarizados' = percent(Precarizados / Empleados, accuracy = 0.1),
'Porcentaje de No Precarizados' = percent(No_Precarizados / Empleados, accuracy = 0.1),
País = "España"
) %>%
mutate(
across(where(is.numeric), ~ ifelse(is.na(.), 0, .)),  # Manejo de NA (si aplica)
across(c(Empleados,Precarizados, No_Precarizados), ~ round(., digits = 0)),  # Redondear a enteros
across(c(Empleados,Precarizados, No_Precarizados), ~ format(., big.mark = ".", decimal.mark = ","))  # Formatear números
) %>%
select(País, Edad_Periodo, Sexo, Empleados, No_Precarizados, Precarizados, 'Porcentaje de No Precarizados', 'Porcentaje de Precarizados')
# Visualizar los indicadores en formato HTML
kable(Cuadro_Precarizacion_ESPAÑA3, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de España según Sexo y Edad - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
## Calculamos la precariedad laboral por Sexo y Edad para Reino Unido
Cuadro_Precarizacion_UK3 <- bbdd_uk3 %>%
group_by(Edad_Periodo, Sexo) %>%  # Agrupar por edad y sexo
summarise(
Empleados = sum((STAPRO %in% c(3,4)) * (COEFF * 1000), na.rm = TRUE),
Temporales = sum((TEMP == 2) * (COEFF * 1000), na.rm = TRUE),
Sin_pago_horas_extra = sum((HWOVERPU >= 1 & HWOVERPU <= 98) * (COEFF * 1000), na.rm = TRUE),
No_perciben_salario_completo = sum((SIGNISAL %in% c(1,2,3)) * (COEFF * 1000), na.rm = TRUE),
Temporales_o_SinPagoHSEXTRA_sin_salario_completo = sum(((TEMP == 2) | (HWOVERPU >= 1 & HWOVERPU <= 98) | (SIGNISAL %in% c(1,2,3))) * (COEFF * 1000), na.rm = TRUE),
Precarizados = Temporales_o_SinPagoHSEXTRA_sin_salario_completo,
No_Precarizados = Empleados - Precarizados,
'Porcentaje de Precarizados' = percent(Precarizados / Empleados, accuracy = 0.1),
'Porcentaje de No Precarizados' = percent(No_Precarizados / Empleados, accuracy = 0.1),
País = "Reino Unido"
) %>%
mutate(
across(where(is.numeric), ~ ifelse(is.na(.), 0, .)),  # Manejo de NA (si aplica)
across(c(Empleados,Precarizados, No_Precarizados), ~ round(., digits = 0)),  # Redondear a enteros
across(c(Empleados,Precarizados, No_Precarizados), ~ format(., big.mark = ".", decimal.mark = ","))  # Formatear números
) %>%
select(País, Edad_Periodo, Sexo, Empleados, No_Precarizados, Precarizados, 'Porcentaje de No Precarizados', 'Porcentaje de Precarizados')
# Visualizar los indicadores en formato HTML
kable(Cuadro_Precarizacion_UK3, format = "html", table.attr = "class='table table-striped'", caption = "Indicadores de Precarización del Mercado de Trabajo de Reino Unido según Sexo y Edad - 2018. Fuente: EU LFS 2018-Q1") %>%
kable_styling(full_width = F, position = "center")
